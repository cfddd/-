
把套接字比喻成电话，那么目前只安装了电话机，本章讲解给电话机分配号码的方法，即给套接字分配 IP 地址和端口号。

## 分配给套接字的 IP 地址
IP 是 Internet Protocol（网络协议）的简写，是为手法网络数据而分配给计算机的值。端口号并非赋予 计算机的值，而是为了区分程序中创建的套接字而分配给套接字的端口号。

**向相应网络传输数据**实际上是向构成网络的路由器或者交换机传输数据，然后又路由器或者交换机根据数据中的主机地址向目标主机传递数据。

只需通过IP地址的第一个字节即可判断网络地址占用的总字节数，因为我们根据IP地址的边界区分网络地址，如下所示：

| | 首字节范围 | 首位 |
| :----: | :----: | :-----: |
| A类地址 | 0~127  | 首位以 0 开始 | 
| B类地址 | 128~191  |  前2位以 10 开始 |
| C类地址 | 192~223  |  前3位以 110 开始 |
因此套接字收发数据时，数据传到网络后即可轻松找到主机。

## 分配给套接字的 端口号

端口号就是在同一操作系统内为区分不同套接字而设置的，因此无法将1个端口号分配给不同套接字。另外，端口号由16位构成，可分配的端口号范围是0-65535。但0-1023是知名端口
( Well-known PORT )，一般分配给特定应用程序，所以应当分配此范围之外的值。另外，虽然端口号不能重复，但TCP套接字和UDP套接字不会共用端口号，所以允许重复。例如:如果某TCP
套接字使用9190号端口，则其他TCP套接字就无法使用该端口号，但UDP套接字可以使用。
## 地址信息的表示
![](addition/Pasted%20image%2020230803162346.png)
![](addition/Pasted%20image%2020230803162412.png)
- 成员 sin_family

| 地址族（Address Family） | 含义 |
| - | - |
| AF_INET | IPV4用的地址族 |
| AF_INET6 | IPV6用的地址族 |
| AF_LOCAL | 本地通信中采用的 Unix 协议的地址族 |

## 网络字节序与地址变换
- 大端序（Big Endian）：高位字节存放到低位地址 
- 小端序（Little Endian）：高位字节存放到高位地址

帮助转换字节序的函数：
```cpp
unsigned short htons(unsigned short);
unsigned short ntohs(unsigned short);
unsigned long htonl(unsigned long); 
unsigned long ntohl(unsigned long);
```


## 网络地址的初始化与分配
- 服务端**lNADDR ANY**
	同一计算机中可以分配多个IP地址，实际P地址的个数与计算机中安装的NIC的数量相等。即使是服务器端套接字，也需要决定应接收哪个IP传来的(哪个NIC传来的）数据。因此，服务器端套接字初始化过程中要求IP地址信息。另外，若只有1个NIC，则直接使用INADDR_ANY。
- 客户端声明sockaddr in结构体，并初始化为要与之连接的服务器端套接字的IP和端口号，然后调用connect函数。

## 向套接字分配网络地址
把初始化的地址信息分配给套接字


```cpp
#include <sys/socket.h>
int bind(int sockfd,struct sockaddr * myaddr, socklen_t addrlen);

```
