HTTP（HyperText Transfer Protocol，超文本传输协议）是用于传输诸如 HTML 等超媒体文档的应用层协议，其通信过程如下：

  

### 一、建立 TCP 连接

  

1. **客户端发起连接请求**
    - 客户端（如浏览器）通过生成一个随机的源端口，并指定目标端口（HTTP 默认端口为 80，HTTPS 默认端口为 443），向服务器的 IP 地址发送一个 TCP 连接请求（SYN 包）。这一过程就像是客户端在向服务器 “敲门”，询问是否可以建立连接。
2. **服务器响应连接请求**
    - 服务器收到客户端的 SYN 包后，如果服务器有资源且愿意接受连接，它会返回一个包含确认号（ACK）和自身同步序列号（SYN）的包给客户端。这相当于服务器回应客户端 “可以进来”，同时也向客户端表明自己的身份。
3. **客户端确认连接**
    - 客户端收到服务器的响应后，再向服务器发送一个确认包（ACK），完成 TCP 三次握手。至此，TCP 连接正式建立，就好像在客户端和服务器之间建立了一条通信的 “管道”，双方可以通过这条 “管道” 进行数据传输。

  

### 二、客户端发送 HTTP 请求

  

1. **请求行**
    - 客户端通过已建立的 TCP 连接向服务器发送 HTTP 请求。请求的第一行是请求行，它包含了请求方法（如 GET、POST、PUT、DELETE 等）、请求的 URL（Uniform Resource Locator，统一资源定位符）和 HTTP 协议版本（如 HTTP/1.1、HTTP/2 等）。例如，`GET /index.html HTTP/1.1`表示客户端使用 GET 方法请求服务器上的`/index.html`资源，且遵循 HTTP/1.1 协议。
2. **请求头**
    - 紧接着请求行的是请求头，它包含了一系列键值对，用于传递客户端的附加信息。常见的请求头有：
        - `User - Agent`：标识客户端的软件类型和版本，例如`User - Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36`，这表明客户端使用的是 Chrome 浏览器。
        - `Host`：指定请求的主机名，因为一台服务器可能托管多个域名的网站，例如`Host: www.example.com`。
        - `Accept`：表示客户端能够接受的媒体类型，如`Accept: text/html,application/xhtml + xml,application/xml;q = 0.9,image/avif,image/webp,image/apng,*/*;q = 0.8,application/signed - exchange;v = b3;q = 0.9`，说明客户端可以接受多种格式的内容，其中对`text/html`等格式有较高的偏好。
3. **请求体（可选）**
    - 如果是 POST 等请求方法，还会有请求体。请求体包含了客户端要发送给服务器的数据，如表单数据、文件上传数据等。例如，在提交一个用户登录表单时，用户名和密码可能就在请求体中以特定的格式（如`application/x - www - form - urlencoded`格式：`username = user123 & password = pass456`）进行传递。

  

### 三、服务器处理请求

  

1. **解析请求**
    - 服务器收到客户端的 HTTP 请求后，首先解析请求行，确定请求方法和请求的资源路径。然后，服务器会解析请求头，获取客户端的相关信息，如客户端类型、可接受的内容类型等。
2. **处理资源请求**
    - 根据请求的 URL，服务器查找对应的资源。如果请求的是静态资源（如 HTML 文件、图片、CSS 文件等），服务器会直接从文件系统中读取相应的文件。如果请求的是动态资源（如由 PHP、[ASP.NET](https://asp.net/)等脚本语言生成的页面），服务器会将请求传递给相应的后端处理程序（如 PHP 解释器）进行处理。例如，对于一个 PHP 文件，服务器会将请求交给 PHP - FPM（PHP - FastCGI Process Manager）来处理，PHP - FPM 会执行 PHP 代码，可能会与数据库交互，生成动态内容。
3. **生成响应**
    - 服务器处理完请求后，会生成 HTTP 响应。响应的第一行是响应行，包含 HTTP 协议版本、响应状态码和状态描述。例如，`HTTP/1.1 200 OK`表示响应遵循 HTTP/1.1 协议，状态码为 200，表示请求成功处理，状态描述为 “OK”。
    - 响应头包含了服务器返回给客户端的附加信息，如`Content - Type`（用于指示响应内容的类型，如`Content - Type: text/html`表示返回的内容是 HTML 格式）、`Content - Length`（表示响应体的长度）等。
    - 如果有响应体，它包含了服务器要返回给客户端的实际内容，如 HTML 页面、JSON 数据等。

  

### 四、服务器发送 HTTP 响应

  

1. **通过 TCP 连接发送响应**
    - 服务器将生成的 HTTP 响应通过之前建立的 TCP 连接发送给客户端。它按照响应行、响应头、响应体的顺序依次发送数据。发送过程就像是把打包好的 “包裹”（包含响应内容）通过 “管道”（TCP 连接）传递给客户端。
2. **关闭 TCP 连接（可选）**
    - 根据 HTTP/1.0 和 HTTP/1.1 协议的不同，以及服务器和客户端的配置，服务器可能在发送完响应后立即关闭 TCP 连接，或者保持连接一段时间以便客户端可以发起后续的请求。在 HTTP/1.1 中，默认采用持久连接（keep - alive），即保持连接打开状态，这样可以减少建立连接的开销，提高通信效率。

  

### 五、客户端接收和处理响应

  

1. **接收响应**
    - 客户端通过 TCP 连接接收服务器发送的 HTTP 响应。它首先接收响应行，获取响应状态码，判断请求是否成功处理。然后接收响应头，获取服务器返回的附加信息，如内容类型、长度等。
2. **处理响应内容**
    - 根据响应头中的`Content - Type`，客户端知道如何处理响应体中的内容。例如，如果`Content - Type`是`text/html`，客户端（浏览器）会将响应体中的 HTML 内容进行解析和渲染，展示网页内容给用户；如果是`application/json`，客户端可能会将 JSON 数据进行解析，并在应用程序中进行相应的处理，如在 JavaScript 应用中，通过`JSON.parse()`方法将 JSON 数据转换为 JavaScript 对象进行操作。

  

以上就是 HTTP 协议的基本通信过程。随着技术的发展，HTTP/2、HTTP/3 等新版本不断出现，在性能和功能上有了进一步的优化和提升，但其基本的通信框架仍然是基于上述的流程。