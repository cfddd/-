## 分布式系统理论：CAP 理论（Consistency-Availability-Partition tolerance Theory）.

（1）C：Consitency，一致性.

意味着在分布式系统中的所有节点看到的数据是相同的。该项**强调数据的正确性**。

具体而言，每次读操作，要么读到最新，要么读失败，如果一个节点修改了数据，那么其他所有节点应该尽快看到这一修改。

（2）A：Availability，可用性.

该项站在使用者的角度，**强调使用服务的可靠性**。客户端的请求能够得到响应，不发生错误，也不能出现过长的等待时间。

这意味着系统在面对节点故障或延迟的情况下，仍然能够保持可用的状态，能够继续处理和响应请求。

（3）P：Partition tolerance，分区容错性.

分区容错性强调的是，在网络环境不可靠的背景下，整个系统仍然是正常运作的，不至于出现系统崩溃或者秩序混乱的局面，**任然保持一致性和可用性**

> CAP 理论一定是可以全部达到的吗？

首先明确，这是一个**不可能三角**，最多只能实现其中的两个

CAP 理论在一个系统中，C、A、P 三项性质至多只能满足其二，即每个系统依据其架构设计会具有 CP、AP 或者 CA 的倾向性.

首先，对于单机系统，其无须考虑 P，因此可以保证 CA 的满足；

其次，**对于分布式系统而言, P 是必须得到保证的，否则这就违背了“分布式”的语义**，显然，想要**让分布式系统能够和单机系统一样保持CA是不可能的**。那么分布式系统会分为两种流派：

（1）**CP**：**强调系统数据的正确性**，但由于建立保证不同节点间保证数据严格一致的机制，可能会牺牲系统的可用性.

（2）**AP**：**强调系统的可用性**，那就必须在数据一致性上做出妥协退让.

> **为什么CA类型不能够同时达到？**

我们模拟一个分布式系统，有一个主节点，多个从节点

为了达成**C数据一致性**，主节点需要向从节点同步信息时，必须等待 **全部从节点** 完成才可以保证一致性。可以发现，代价是时间比较长，提供服务慢

为了达成**A节点可用性**，主节点需要向从节点同步信息时，只要有一个从节点同步成功就可以，但代价是，可能存在不一致性现象，甚至极端情况下数据丢失

综上，**可以发现无论我们在主节点向从节点的同步，采用什么策略，都会受到两方的掣肘**

> NoSQL数据库（Redis） 是什么类型

AP 类型

> 分布式数据库（例如：Etcd、zookeeper等等） 是什么类型

CP 类型

但分布式关系型数据库仍有高可用性需求，虽然达不到CAP理论中的100%可用性，但一般都具备五个9(99.999%)以上的高可用。

## 辩证看待CAP理论
选择C，或者是A，**并不意味着一定会完全抛弃另一个**

实际上，在设计其中任意一个分布式系统，当我们在 C 和 A 之间做出抉择之后，对另一个最合理的做法是 **“降级”**，也就是一方向另一方让步