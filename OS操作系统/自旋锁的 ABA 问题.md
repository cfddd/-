## 产生 ABA 问题的 CAS 机制
CAS（Compare and Swap）是一种乐观锁机制。CAS有3个操作数，预期值A，内存值V，要修改的新值B。当且仅当预期值A和内存值V相同时，将内存值V修改为B，否则什么都不做。

整个 CAS 操作是原子的，即在执行过程中不会被中断，确保多个线程并发执行时不会出现竞态条件。

ABA性质是指在使用自旋锁时，存在一种特定的情况，即一个线程在检查共享资源的值时，发现它的值为A，然后另一个线程将共享资源的值修改为B，接着再修改回A，最后第一个线程再次检查共享资源的值时，仍然发现它的值为A。

> 比如线程 x 和 线程 y 对同一个 int64 并发操作， x 要给 int64 + 1 ，前提是 int64 没有改变过；y 给 int64 +1 后又 -1
>
>如果 x 发现操作对象 int64 没有变过，显然不能判断是否 y 有没有操作。
>还会带来一些问题：
>
>1. 对线程 x 是否有影响，或者有那些潜在的影响
>2. 什么情况下需要考虑这个 ABA 问题
>3. 有哪些解决方案

## ABA问题的解决
解决ABA问题的常见方法是**使用版本号或者标记来标识共享资源的状态变化，以确保在检查共享资源的值时能够准确地判断其是否发生了变化**。

例如，可以在每次修改共享资源时都增加一个版本号，这样即使共享资源的值由A变为B再变回A，但是版本号会随着每次修改而增加，从而确保每次修改都能够被正确地识别出来。
